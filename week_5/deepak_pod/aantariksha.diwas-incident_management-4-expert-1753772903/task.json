{
    "env": "incident_management",
    "model_provider": "openai",
    "model": "o4-mini",
    "num_trials": 3,
    "temperature": 1,
    "interface_num": 4,
    "task": {
        "user_id": "2",
        "instruction": "You are Kristina Williams (email: kristina.williams@davis-huynh.com) and a suspicious email reported by multiple employees is suspected to be a phishing attempt targeting internal credentials. You want to find the incidents under the sub-category ‘Phishing Report’ in your company and make a new incident task under that incident ID with the description 'Analyze reported email and isolate potentially compromised accounts', marked as 'high' priority and assigned to the user ID: 47. If there is no incident with this subcategory, you want to use incident ID: 26. You’d like a public comment added saying: 'Preliminary review underway. Employees advised not to engage with the email. Forensics in progress.' You also want to upload the reported email sample as a file named 'phishing_email_sample.eml' using the file URL '/uploads/security/phishing/phishing_email_sample.eml’ to this incident. Lastly, you want a knowledge base article created titled 'How to Identify and Report Phishing Emails', and have it linked to the same incident to assist with employee awareness going forward. At last, you want to set the status of task as ‘todo’ as you forget to do it before and verify if it is logged succesfully.",
        "actions": [
            {
                "name": "filter_users",
                "arguments": {
                    "email": "kristina.williams@davis-huynh.com"
                },
                "output": [
                    {
                        "company_id": "13",
                        "created_at": "2025-02-02T00:41:50.626302",
                        "department_id": "21",
                        "email": "kristina.williams@davis-huynh.com",
                        "first_name": "Kristina",
                        "last_name": "Williams",
                        "role": "agent",
                        "status": "active",
                        "timezone": "Asia/Qyzylorda",
                        "updated_at": "2025-02-02T00:41:50.626302",
                        "user_id": "2"
                    }
                ]
            },
            {
                "name": "filter_subcategories",
                "arguments": {
                    "name": "Phishing Report"
                },
                "output": [
                    {
                        "category_id": "8",
                        "created_at": "2025-03-27T05:05:05.648586",
                        "name": "Phishing Report",
                        "subcategory_id": "26",
                        "updated_at": "2025-03-27T05:05:05.648586"
                    }
                ]
            },
            {
                "name": "query_incidents",
                "arguments": {
                    "company_id": "13",
                    "subcategory_id": "26"
                },
                "output": []
            },
            {
                "name": "create_incident_task",
                "arguments": {
                    "incident_id": "26",
                    "description": "Analyze reported email and isolate potentially compromised accounts",
                    "assigned_to": "47",
                    "priority": "high"
                },
                "output": {
                    "task_id": 143
                }
            },
            {
                "name": "add_incident_comment",
                "arguments": {
                    "incident_id": "26",
                    "user_id": "2",
                    "comment_text": "Preliminary review underway. Employees advised not to engage with the email. Forensics in progress.",
                    "is_public": "True"
                },
                "output": {
                    "comment_text": "Preliminary review underway. Employees advised not to engage with the email. Forensics in progress.",
                    "created_at": "2025-10-01T00:00:00",
                    "incident_comment_id": 787,
                    "incident_id": "26",
                    "is_public": true,
                    "updated_at": "2025-10-01T00:00:00",
                    "user_id": "2"
                }
            },
            {
                "name": "add_incident_attachment",
                "arguments": {
                    "incident_id": "26",
                    "uploaded_by": "2",
                    "file_name": "phishing_email_sample.eml",
                    "file_url": "/uploads/security/phishing/phishing_email_sample.eml"
                },
                "output": {
                    "incident_attachment_id": 202
                }
            },
            {
                "name": "create_kb_article",
                "arguments": {
                    "description": "How to Identify and Report Phishing Emails",
                    "created_by": "2",
                    "company_id": "13"
                },
                "output": {
                    "category_id": null,
                    "company_id": "13",
                    "created_at": "2025-10-01T00:00:00",
                    "created_by": "2",
                    "department_id": null,
                    "description": "How to Identify and Report Phishing Emails",
                    "knowledge_base_id": 51,
                    "subcategory_id": null,
                    "updated_at": "2025-10-01T00:00:00"

                }
            },
            {
                "name": "link_incident_to_kb",
                "arguments": {
                    "incident_id": "26",
                    "knowledge_base_id": "51"
                },
                "output": {
                    "created_at": "2025-10-01T00:00:00",
                    "incident_id": "26",
                    "knowledge_base_id": "51"
                }
            },
            {
                "name": "update_task",
                "arguments": {
                    "task_id": 143,
                    "status": "todo"
                },
                "output": {
                    "assigned_to": 47,
                    "created_at": "2025-10-01T00:00:00",
                    "description": "Analyze reported email and isolate potentially compromised accounts",
                    "due_date": null,
                    "incident_id": "26",
                    "priority": "high",
                    "status": "todo",
                    "task_id": 143,
                    "updated_at": "2025-10-01T00:00:00"
                }
            },
            {
                "name": "get_incident_tasks",
                "arguments": {
                    "incident_id": 26,
                    "status": "todo"
                },
                "output": [
                {
                    "assigned_to": 47,
                    "created_at": "2025-10-01T00:00:00",
                    "description": "Analyze reported email and isolate potentially compromised accounts",
                    "due_date": null,
                    "incident_id": "26",
                    "priority": "medium",
                    "status": "todo",
                    "task_id": 143,
                    "updated_at": "2025-10-01T00:00:00"
                }
            ]
            }
            
        ],
        "edges": [
            {
                "from": "instruction",
                "to": "filter_users",
                "connection": {
                    "output": "email",
                    "input": "email"
                }
            },
            {
                "from": "instruction",
                "to": "filter_subcategories",
                "connection": {
                    "output": "name",
                    "input": "name"
                }
            },
            {
                "from": "filter_users",
                "to": "query_incidents",
                "connection": {
                    "output": "output[0].company_id",
                    "input": "company_id"
                }
            },
            {
                "from": "filter_subcategories",
                "to": "query_incidents",
                "connection": {
                    "output": "output[0].subcategory_id",
                    "input": "subcategory_id"
                }
            },
            {
                "from": "instruction",
                "to": "create_incident_task",
                "connection": {
                    "output": "incident_id, assigned_to, description, priority",
                    "input": "incident_id, assigned_to, description, priority"
                }
            },
            {
                "from": "filter_users",
                "to": "add_incident_comment",
                "connection": {
                    "output": "output[0].user_id",
                    "input": "user_id"
                }
            },
            {
                "from": "instruction",
                "to": "add_incident_comment",
                "connection": {
                    "output": "incident_id, comment_text, is_public",
                    "input": "incident_id, comment_text, is_public"
                }
            },
            {
                "from": "add_incident_comment",
                "to": "add_incident_attachment",
                "connection": {
                    "output": "incident_id, user_id",
                    "input": "incident_id, uploaded_by"
                }
            },
            {
                "from": "instruction",
                "to": "add_incident_attachment",
                "connection": {
                    "output": "file_name, file_url",
                    "input": "file_name, file_url"
                }
            },
            {
                "from": "filter_users",
                "to": "create_kb_article",
                "connection": {
                    "output": "output[0].user_id, output[0].company_id",
                    "input": "created_by, company_id"
                }
            },
            {
                "from": "instruction",
                "to": "create_kb_article",
                "connection": {
                    "output": "description",
                    "input": "description"
                }
            },
            {
                "from": "create_kb_article",
                "to": "link_incident_to_kb",
                "connection": {
                    "output": "knowledge_base_id",
                    "input": "knowledge_base_id"
                }
            },
            {
                "from": "instruction",
                "to": "link_incident_to_kb",
                "connection": {
                    "output": "incident_id",
                    "input": "incident_id"
                }
            },
            {
                "from": "create_incident_task",
                "to": "update_task",
                "connection": {
                    "output": "task_id",
                    "input": "task_id"
                }
            },
            {
                "from": "instruction",
                "to": "update_task",
                "connection": {
                    "output": "status",
                    "input": "status"
                }
            },
            {
                "from": "instruction",
                "to": "get_incident_tasks",
                "connection": {
                    "output": "incident_id, status",
                    "input": "incident_id, status"
                }
            }

        ],
        "outputs": [
            "2",
            "202",
            "51"
        ],
        "num_edges": 16
    }
}
